## 执行环境
执行环境有全局执行环境（也称全局环境）和函数执行环境之分。执行环境如其名是在运行和执行代码的时候才存在的，所以我们运行浏览器的时候会创建全局的执行环境，在调用函数时，会创建函数执行环境
1. 全局执行环境  
全局执行环境是最外围的一个执行环境，在web浏览器中，我们可以认为他是window对象，因此所有的全局变量和函数都是作为window对象的属性和方法创建的
2. 函数执行环境  
函数都有自己的执行环境，当执行流进入一个函数时，函数的环境就被推入一个环境栈中，当函数执行完毕后，栈将其环境弹出，把控制权返回给之前的执行环境

## 作用域 作用域链
```
var color = 'red';
console.log(color); //red
function changecolor() {
    var name = 'joke';
    console.log(name); //joke
    color = 'blue';
    console.log(color); //blue
}
changecolor();
console.log(color) //blue
```
1. 全局作用域  
上方代码：`color`是拥有全局作用域。  
在函数中声明变量时，如果省略 var 操作符，那么声明的变量就是全局变量，拥有全局作用域，但是不推荐这种做法，因为在局部作用域中很难维护定义的全局变量。  
window对象的内置属性都拥有全局作用域。
全局作用域不可以访问局部作用域的变量。
2. 局部作用域
`name`只能在函数`changecolor`中访问。局部作用域可以访问父级乃至全局作用域的变量。

3. 作用域链  
每次进入一个新的执行环境，都会创建一个用于搜索变量和函数的作用域链。作用域链是函数被创建的作用域中对象的集合。作用域链可以保证对执行环境有权访问的所有变量和函数的有序访问。  
作用域链的最前端始终是当前执行的代码所在环境的变量对象（如果该环境是函数，则将其活动对象作为变量对象），下一个变量对象来自包含环境（包含当前还行环境的环境），下一个变量对象来自包含环境的包含环境，依次往上，直到全局执行环境的变量对象。全局执行环境的变量对象始终是作用域链中的最后一个对象。  
标识符解析是沿着作用域一级一级的向上搜索标识符的过程。搜索过程始终是从作用域的前端逐地向后回溯，直到找到标识符（找不到，就会导致错误发生）

## 预解析

首先js是顺序执行的
```
test();

function test() {
    console.log('hah')
}
```
测试代码成功打印处了`hah`,这是因为什么呢？就是源于js的预解析。
* 变量的预解析
* 函数的预解析     

1. 变量预解析
```
console.log(a) //undefined
var a = '1';
console.log(a) //1
```
变量在预解析时，也会进行提升，但是没有赋值，值为`undefined`

2. 函数预解析
```
test();

function test() {
    console.log('hah')
}
```
3. 变量函数重名情况
```
console.log(a) //f a() {}
var a = '1';
function a () {
    console.log('a')
}
console.log(a) //1
```
函数优先级高于变量名  

4. 预解析不可以跨`script`标签
```
<script type="text/javascript">
alert(b);//报错
</script>

<script type="text/javascript">
var b=1;
</script>
```
如果先定义就正常执行，因为顺序执行，已经定义为全局变量。

5. 预解析是在程序进入一个新的环境时，把该环境里的变量或函数预解析到它们能调用的环境中。即每一次预解析的单位是一个执行环境
```
var b = 1;
function a(b) {
    console.log(b) //undefined
    b = 2;
    console.log(b) //2
}
a();
console.log(b) //1
```
函数参数其实可以理解为在函数作用域中 `var b`;